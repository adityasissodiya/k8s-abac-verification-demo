<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: framework_arch Pages: 1 -->
<svg width="947pt" height="311pt"
 viewBox="0.00 0.00 946.76 310.93" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 306.93)">
<title>framework_arch</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-306.93 942.76,-306.93 942.76,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_k8s</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="284.15,-59.06 284.15,-169.06 930.76,-169.06 930.76,-59.06 284.15,-59.06"/>
<text text-anchor="middle" x="607.46" y="-153.86" font-family="Times,serif" font-size="14.00">Kubernetes Cluster</text>
</g>
<!-- API -->
<g id="node1" class="node">
<title>API</title>
<ellipse fill="none" stroke="black" cx="393.27" cy="-94.06" rx="101.23" ry="26.74"/>
<text text-anchor="middle" x="393.27" y="-97.86" font-family="Helvetica,sans-Serif" font-size="14.00">API Server</text>
<text text-anchor="middle" x="393.27" y="-82.86" font-family="Helvetica,sans-Serif" font-size="14.00">(RBAC Authorizer)</text>
</g>
<!-- Adapter -->
<g id="node2" class="node">
<title>Adapter</title>
<ellipse fill="none" stroke="black" cx="842.15" cy="-111.06" rx="80.72" ry="26.74"/>
<text text-anchor="middle" x="842.15" y="-114.86" font-family="Helvetica,sans-Serif" font-size="14.00">ABAC Adapter</text>
<text text-anchor="middle" x="842.15" y="-99.86" font-family="Helvetica,sans-Serif" font-size="14.00">(Webhook)</text>
</g>
<!-- API&#45;&gt;Adapter -->
<g id="edge2" class="edge">
<title>API&#45;&gt;Adapter</title>
<path fill="none" stroke="black" d="M488.05,-84.42C558.59,-78.98 657.49,-75.22 743.54,-86.06 752.65,-87.21 762.14,-88.94 771.45,-90.96"/>
<polygon fill="black" stroke="black" points="770.94,-94.43 781.47,-93.26 772.5,-87.61 770.94,-94.43"/>
<text text-anchor="middle" x="655.54" y="-89.86" font-family="Helvetica,sans-Serif" font-size="14.00">AuthZ webhook call</text>
</g>
<!-- User -->
<g id="node5" class="node">
<title>User</title>
<text text-anchor="middle" x="842.15" y="-24.86" font-family="Helvetica,sans-Serif" font-size="14.00">User/Admin</text>
<text text-anchor="middle" x="842.15" y="-9.86" font-family="Helvetica,sans-Serif" font-size="14.00">(kubectl client)</text>
</g>
<!-- API&#45;&gt;User -->
<g id="edge6" class="edge">
<title>API&#45;&gt;User</title>
<path fill="none" stroke="black" d="M473.47,-77.62C502.94,-71.74 536.71,-65.28 567.54,-60.06 637.13,-48.28 717.08,-37.16 772.51,-29.83"/>
<polygon fill="black" stroke="black" points="773.11,-33.29 782.57,-28.51 772.2,-26.35 773.11,-33.29"/>
<text text-anchor="middle" x="655.54" y="-63.86" font-family="Helvetica,sans-Serif" font-size="14.00">Response allowed/denied</text>
</g>
<!-- Adapter&#45;&gt;API -->
<g id="edge5" class="edge">
<title>Adapter&#45;&gt;API</title>
<path fill="none" stroke="black" d="M761.83,-108.24C707.21,-106.28 632.97,-103.58 567.54,-101.06 546.76,-100.26 524.59,-99.38 503.28,-98.53"/>
<polygon fill="black" stroke="black" points="503.36,-95.03 493.23,-98.12 503.08,-102.02 503.36,-95.03"/>
<text text-anchor="middle" x="655.54" y="-110.86" font-family="Helvetica,sans-Serif" font-size="14.00">AuthZ response</text>
</g>
<!-- PDP -->
<g id="node3" class="node">
<title>PDP</title>
<ellipse fill="none" stroke="black" cx="393.27" cy="-276.06" rx="156.04" ry="26.74"/>
<text text-anchor="middle" x="393.27" y="-279.86" font-family="Helvetica,sans-Serif" font-size="14.00">AuthzForce PDP</text>
<text text-anchor="middle" x="393.27" y="-264.86" font-family="Helvetica,sans-Serif" font-size="14.00">(XACML Policy Decision Point)</text>
</g>
<!-- Adapter&#45;&gt;PDP -->
<g id="edge3" class="edge">
<title>Adapter&#45;&gt;PDP</title>
<path fill="none" stroke="black" d="M776.81,-126.86C718.43,-143.32 631.9,-173.2 567.54,-219.06 557.53,-226.19 560.05,-233.69 549.54,-240.06 540.21,-245.72 530.07,-250.49 519.59,-254.5"/>
<polygon fill="black" stroke="black" points="518.12,-251.32 509.89,-257.99 520.48,-257.9 518.12,-251.32"/>
<text text-anchor="middle" x="655.54" y="-222.86" font-family="Helvetica,sans-Serif" font-size="14.00">XACML query</text>
</g>
<!-- PDP&#45;&gt;Adapter -->
<g id="edge4" class="edge">
<title>PDP&#45;&gt;Adapter</title>
<path fill="none" stroke="black" d="M544.81,-282.83C609.52,-279.66 683.84,-267.44 743.54,-234.06 779.29,-214.07 806.7,-175.18 823.24,-146.46"/>
<polygon fill="black" stroke="black" points="826.41,-147.97 828.23,-137.53 820.3,-144.55 826.41,-147.97"/>
<text text-anchor="middle" x="655.54" y="-284.86" font-family="Helvetica,sans-Serif" font-size="14.00">Permit/Deny decision</text>
</g>
<!-- SMT -->
<g id="node4" class="node">
<title>SMT</title>
<ellipse fill="#ffec8b" stroke="black" cx="393.27" cy="-204.06" rx="111.03" ry="26.74"/>
<text text-anchor="middle" x="393.27" y="-207.86" font-family="Helvetica,sans-Serif" font-size="14.00">SMT Solver</text>
<text text-anchor="middle" x="393.27" y="-192.86" font-family="Helvetica,sans-Serif" font-size="14.00">(Verification Engine)</text>
</g>
<!-- User&#45;&gt;API -->
<g id="edge1" class="edge">
<title>User&#45;&gt;API</title>
<path fill="none" stroke="black" d="M782.41,-9.86C726.44,-1.25 640.17,6.62 567.54,-10.06 522.23,-20.47 475.01,-44.36 441.33,-64.01"/>
<polygon fill="black" stroke="black" points="439.46,-61.05 432.64,-69.16 443.03,-67.07 439.46,-61.05"/>
<text text-anchor="middle" x="655.54" y="-13.86" font-family="Helvetica,sans-Serif" font-size="14.00">API request</text>
</g>
<!-- RBACpol -->
<g id="node6" class="node">
<title>RBACpol</title>
<polygon fill="none" stroke="black" points="169.5,-154.06 24.5,-154.06 24.5,-118.06 175.5,-118.06 175.5,-148.06 169.5,-154.06"/>
<polyline fill="none" stroke="black" points="169.5,-154.06 169.5,-148.06 "/>
<polyline fill="none" stroke="black" points="175.5,-148.06 169.5,-148.06 "/>
<text text-anchor="middle" x="100" y="-132.36" font-family="Helvetica,sans-Serif" font-size="14.00">RBAC Policy (YAML)</text>
</g>
<!-- RBACpol&#45;&gt;API -->
<g id="edge7" class="edge">
<title>RBACpol&#45;&gt;API</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M175.63,-125.3C211.61,-120.11 255.23,-113.82 293.88,-108.25"/>
<polygon fill="black" stroke="black" points="294.71,-111.66 304.11,-106.77 293.72,-104.74 294.71,-111.66"/>
</g>
<!-- RBACpol&#45;&gt;SMT -->
<g id="edge9" class="edge">
<title>RBACpol&#45;&gt;SMT</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M163.74,-154.1C186.7,-160.44 212.94,-167.39 237,-173.06 255.68,-177.46 275.73,-181.77 295,-185.7"/>
<polygon fill="black" stroke="black" points="294.5,-189.17 304.99,-187.73 295.89,-182.31 294.5,-189.17"/>
</g>
<!-- ABACpol -->
<g id="node7" class="node">
<title>ABACpol</title>
<polygon fill="none" stroke="black" points="194,-285.06 0,-285.06 0,-249.06 200,-249.06 200,-279.06 194,-285.06"/>
<polyline fill="none" stroke="black" points="194,-285.06 194,-279.06 "/>
<polyline fill="none" stroke="black" points="200,-279.06 194,-279.06 "/>
<text text-anchor="middle" x="100" y="-263.36" font-family="Helvetica,sans-Serif" font-size="14.00">ABAC Policy (XACML/ALFA)</text>
</g>
<!-- ABACpol&#45;&gt;PDP -->
<g id="edge8" class="edge">
<title>ABACpol&#45;&gt;PDP</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M200.02,-270.12C209.44,-270.41 219.16,-270.71 228.98,-271.02"/>
<polygon fill="black" stroke="black" points="229.15,-274.52 239.25,-271.33 229.37,-267.53 229.15,-274.52"/>
</g>
<!-- ABACpol&#45;&gt;SMT -->
<g id="edge10" class="edge">
<title>ABACpol&#45;&gt;SMT</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M184.47,-249.01C220.58,-241.2 262.96,-232.03 300.01,-224.02"/>
<polygon fill="black" stroke="black" points="300.76,-227.43 309.8,-221.9 299.29,-220.59 300.76,-227.43"/>
</g>
<!-- Invariant -->
<g id="node8" class="node">
<title>Invariant</title>
<polygon fill="none" stroke="black" points="167.5,-222.06 26.5,-222.06 26.5,-186.06 173.5,-186.06 173.5,-216.06 167.5,-222.06"/>
<polyline fill="none" stroke="black" points="167.5,-222.06 167.5,-216.06 "/>
<polyline fill="none" stroke="black" points="173.5,-216.06 167.5,-216.06 "/>
<text text-anchor="middle" x="100" y="-200.36" font-family="Helvetica,sans-Serif" font-size="14.00">Security invariants</text>
</g>
<!-- Invariant&#45;&gt;SMT -->
<g id="edge11" class="edge">
<title>Invariant&#45;&gt;SMT</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M173.75,-204.06C203.45,-204.06 238.6,-204.06 271.93,-204.06"/>
<polygon fill="black" stroke="black" points="272.2,-207.56 282.2,-204.06 272.2,-200.56 272.2,-207.56"/>
</g>
</g>
</svg>
